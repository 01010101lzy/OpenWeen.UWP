<ContentDialog
    x:Class="OpenWeen.UWP.Common.Controls.ImageViewDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:OpenWeen.UWP.Common.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:model="using:OpenWeen.UWP.Model"
    BorderThickness="0"
    xmlns:Extensions="using:WinRTXamlToolkit.Controls.Extensions"
    SecondaryButtonText="关闭"
    RequestedTheme="Dark"
    RightTapped="ContentDialog_RightTapped"
    mc:Ignorable="d" FullSizeDesired="True" Background="#7F000000" Style="{StaticResource PopupStyle}">
    <Grid>
        <FlipView x:Name="flipView" SelectionChanged="flipView_SelectionChanged" Background="Transparent" ItemsSource="{x:Bind Items}" DataContextChanged="flipView_DataContextChanged">
            <FlipView.ItemTemplate>
                <DataTemplate x:DataType="model:ImageModel">
                    <ScrollViewer MaxZoomFactor="50" PointerExited="ScrollViewer_PointerExited" PointerPressed="ScrollViewer_PointerPressed" PointerReleased="ScrollViewer_PointerReleased" PointerMoved="ScrollViewer_PointerMoved" HorizontalScrollBarVisibility="Auto" HorizontalScrollMode="Auto" ZoomMode="Enabled" HorizontalContentAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" VerticalContentAlignment="Center" VerticalScrollBarVisibility="Auto">
                        <Grid>
                            <ProgressRing Foreground="White" IsActive="{x:Bind IsLoading,Mode=OneWay}" />
                            <Image  Tapped="Image_Tapped" ImageFailed="{x:Bind LoadFailed}" ImageOpened="{x:Bind Loaded}"  Source="{Binding SourceUri}"/>
                            <!--<imgcontrol:ImageView LoadingFailed="{x:Bind LoadFailed}" Margin="0,0,16,16" UriSource="{x:Bind SourceUri}" LoadingCompleted="{x:Bind Loaded}" />-->
                        </Grid>
                    </ScrollViewer>
                </DataTemplate>
            </FlipView.ItemTemplate>
        </FlipView>
        <AppBarButton Background="#7F000000" Icon="Back" IsCompact="True" Click="{x:Bind HideEx}" />
        <StackPanel Background="#7F000000" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom">
            <AppBarButton Icon="Save" IsCompact="True" Click="{x:Bind Save}" />
            <AppBarButton IsCompact="True" Click="{x:Bind ZoomOut}" Icon="ZoomOut" />
            <AppBarButton IsCompact="True" Click="{x:Bind ZoomIn}" Icon="ZoomIn" />
        </StackPanel>
    </Grid>
</ContentDialog>